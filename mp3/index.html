<!DOCTYPE html>
<html>
<head>
	<script src="https://rawgithub.com/jDataView/jDataView/master/src/jDataView.js"></script>
	<script src="https://rawgithub.com/jDataView/jBinary/master/src/jBinary.js"></script>
	<script src="mp3.js"></script>
	<script src="https://rawgithub.com/jonathantneal/2869388/raw/989d46f574934be64348b7caf4cc149b007bf76f/eventListener.js"></script>
	<script>
		addEventListener('load', function () {
			var info = document.getElementById('info');

			function handleData(err, data) {
				if (err) {
					return alert(err);
				}

				var mp3 = new jBinary(data, jBinary.Repo.MP3);
				var id3v1 = mp3.read('ID3v1');

				while (info.firstChild) {
					info.removeChild(info.firstChild);
				}

				for (var key in id3v1) {
					if (key.charAt(0) === '_') {
						continue;
					}

					var row = info.insertRow(-1);

					var head = document.createElement('th');
					head.innerHTML = key;
					row.appendChild(head);

					var cell = document.createElement('td');
					cell.innerHTML = id3v1[key];
					row.appendChild(cell);
				}
			}

			document.getElementById('url').addEventListener('click', function (event) {
				var oldTitle = document.title;
				document.title = '...loading, please wait...';
				jBinary.loadData(this.href, function (err, data) {
					document.title = oldTitle;
					handleData.apply(this, arguments);
				});
				event.preventDefault();
			});

			if ('File' in this) {
				document.getElementById('fileApi').style.display = 'block';

				document.getElementById('file').addEventListener('change', function () {
					jBinary.loadData(this.files[0], handleData);
				});
			}
		});
	</script>
	<style type="text/css">
		#fileApi {
			display: none;
		}

		table {
			border-collapse: collapse;
		}

		th, td {
			border: 1px solid #777;
			padding: 3pt;
		}
	</style>
</head>
<body>
	Load MP3 sample: <a id="url" href="sample.mp3">Load</a><br />
	<div id="fileApi">
		<small>or</small><br />
		<label for="file">Choose MP3 file:</label><input type="file" id="file" />
	</div>
	<hr />
	<table>
		<tbody id="info"></tbody>
	</table>
</body>
</html>